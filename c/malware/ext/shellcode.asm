; CREDITS: https://stackoverflow.com/questions/15593214/linux-shellcode-hello-world
BITS 64
global _start

section .text

_start:
    jmp MESSAGE      ; 1) lets jump to MESSAGE

GOBACK:
    mov rax, 0x1
    mov rdi, 0x1
    pop rsi          ; 3) we are poping into `ecx`, now we have the
                     ; address of "Hello, World!\r\n"
    mov rdx, 7
    syscall

    mov rax, 60
    mov rdi, 0x37
    syscall

MESSAGE:
    call GOBACK       ; 2) we are going back, since we used `call`, that means
                      ; the return address, which is in this case the address
                      ; of "Hello, World!\r\n", is pushed into the stack.
    db "Pwned!", 0ah

section .data
